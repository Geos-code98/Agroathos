{% extends 'base/baseathos.html' %}
{% block contenido%}



<section class="contenedor" id="section-usuarios">
	<div id="registration-form">
		<div class='fieldset'>
		<div class="col-lg-6">
					<div class="card">
					<div class="card-header"><strong>Registro</strong><small> SUBHITOS</small></div>
					<div class="card-body card-block">
			<form id="frmajax"  method="post" data-validate="parsley">
				{% csrf_token %}
				<div class='form-group'>
				
					{{legal}}
				</div>

				<div class='form-group'>
					{{form.descripcion.label}}
					{{form.descripcion}}
				</div>
				<div class='form-group'>
					{{form.anexo_macro.label}}
					{{form.anexo_macro}}
				</div>
				<div class='form-group'>
					{{form.anexo_proceso.label}}
					{{form.anexo_proceso}}
				</div>
				<div class='form-group'>
					{{form.anexo_objetivos.label}}
					{{form.anexo_objetivos}}
				</div>
				
				<div class='form-group'>
					{{form.anexo_estructura.label}}
					{{form.anexo_estructura}}
				</div>
				<div class='form-group'>
					{{form.valor.label}}
					{{form.valor}}
				</div>
				
				<input type="submit" value="Registrar" id="registrar" class="btn btn-primary">
			</form>
	</div>
	</div>
</div>
</div>
</div>
</section>
{% endblock %}
{%block script%}
<script type="text/javascript">
   //   $('#id_anexo_cultivo').select2();
      
    ///  $('#id_anexo_eje').select2();
     
    //   $('#id_anexo_fundo').select2();
    //    $('#id_anexo_variable').select2();
      
  //    $("#id_anexo_cultivo").val(2).trigger('change');
      //$("#id_anexo_eje").val(2).trigger('change');
     
      
 function request_proceso (fundoId) {
		var urldata="/ajax/load-procesos/" + fundoId;
     
      $.ajax({                       
        url: urldata,                    
        data: {},
        success: function (data) {
        var option_html = `<option value="0" >---------</option>`;
        for (var i = 0; i < data.length; i++) { 	
        
        		
        			option_html += `<option value="${data[i].id}" >${data[i].descripcion}</option>`;
        		
        } 
        $("#id_anexo_proceso").html(option_html);
        	console.log(option_html);
        },
        error: function(result) {
            console.log(result);
        }

      });

	} 
      
       $("#id_anexo_macro").change(function () { 

      var fundoId = $(this).val();
      	
      request_proceso(fundoId)
    });




 function request_objetivos (fundoId) {
		var urldata="/ajax/load-objetivos/" + fundoId;
     
      $.ajax({                       
        url: urldata,                    
        data: {},
        success: function (data) {
        var option_html = `<option value="0" >---------</option>`;
        for (var i = 0; i < data.length; i++) { 	
        
        		
        			option_html += `<option value="${data[i].id}" >${data[i].descripcion}</option>`;
        		
        } 
        $("#id_anexo_objetivos").html(option_html);
        	console.log(option_html);
        },
        error: function(result) {
            console.log(result);
        }

      });

	} 
      
       $("#id_anexo_proceso").change(function () { 

      var fundoId = $(this).val();
      	
      request_objetivos(fundoId)
    });



  </script>






{% endblock %}